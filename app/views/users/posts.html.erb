<div class="min-h-screen bg-gradient-to-b from-[#C7D3E0] to-[#E5EBF2] py-10 px-6 flex justify-center">
  <div class="bg-white/90 backdrop-blur-md shadow-2xl rounded-3xl p-8 w-full max-w-4xl border border-gray-200">
    
    <!-- 🧑 ヘッダー部分 -->
    <div class="flex items-start mb-8 border-b pb-4">
      <% if @user.icon.attached? %>
        <%= image_tag @user.icon.variant(resize_to_fill: [80, 80]).processed,
                      class: "rounded-full shadow mr-4" %>
      <% else %>
        <%= image_tag "default_icon.png", size: "80x80", class: "rounded-full shadow mr-4" %>
      <% end %>

      <div>
        <h2 class="text-2xl font-bold text-gray-800">
          <%= @user == current_user ? "あなたの投稿一覧" : "#{@user.nickname} さんの投稿" %>
        </h2>
        <% if @user.introduction.present? %>
          <p class="text-sm text-gray-600 mt-1"><%= truncate(@user.introduction, length: 60) %></p>
        <% end %>
      </div>

    </div>

<!-- 投稿一覧 -->
<% if @posts.any? %>
  <div class="grid grid-cols-1 gap-6">
    <% @posts.each do |post| %>
      <div class="p-5 bg-white rounded-2xl shadow-sm border hover:shadow-lg hover:-translate-y-1 transition transform">

        <!-- 🟢 募集状態 -->
        <% if post.status.present? %>
          <div class="text-center mb-2">
            <% if post.recruiting? %>
              <span class="inline-block px-4 py-1 text-xs font-bold text-white rounded-full shadow-sm bg-green-500">
                🟢 コラボ募集中
              </span>
            <% else %>
              <span class="inline-block px-4 py-1 text-xs font-bold text-white rounded-full shadow-sm bg-gray-500">
                🔴 募集停止中
              </span>
            <% end %>
          </div>
        <% end %>

        <!-- タイトル＋ジャンル -->
        <div class="flex items-center justify-between">
          <h3 class="text-lg font-semibold text-gray-800 truncate">
            <%= link_to post.title, post_path(post),
                        class: "text-purple-700 hover:underline" %>
          </h3>
          <% if post.genres.present? %>
            <div class="text-xs font-semibold text-white px-3 py-1 rounded-full shadow bg-gradient-to-r from-orange-400 to-pink-400 whitespace-nowrap">
              <%= post.genres.map(&:name).join(" / ") %>
            </div>
          <% else %>
            <span class="text-xs text-gray-400">ジャンル未設定</span>
          <% end %>
        </div>

        <!-- 説明文 -->
        <% if post.description.present? %>
          <p class="text-sm text-gray-600 mt-2 line-clamp-2">
            <%= truncate(post.description, length: 80) %>
          </p>
        <% end %>

        <!-- 🎸 募集パート -->
        <% if post.looking_for_skills.present? %>
          <p class="text-xs font-semibold text-gray-600 mt-3 mb-1">🎸 募集中のパート：</p>
          <div class="flex flex-wrap gap-2">
            <% post.looking_for_skills.each do |skill| %>
              <span class="text-xs font-medium text-gray-700 bg-gray-100 border border-gray-200 rounded-full px-2.5 py-0.5">
                <%= skill.name %>
              </span>
            <% end %>
          </div>
        <% end %>

        <!-- 投稿日＆コメント数 -->
        <div class="flex items-center justify-between text-xs text-gray-400 mt-3">
          <p>
            投稿日：<%= l(post.created_at, format: :short) %>
            （<%= time_ago_in_words(post.created_at) %>前）
          </p>
          <p>💬 コメント：<%= post.comments.count %></p>
        </div>

      </div>
    <% end %>
  </div>
<% else %>
  <div class="text-center py-12 text-gray-500">
    まだ投稿がありません。
    <% if @user == current_user %>
      <div class="mt-4">
        <%= link_to "🎵 新しい投稿を作成する", new_post_path,
            class: "inline-block px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-lg shadow-md transition" %>
      </div>
    <% end %>
  </div>
<% end %>

<!-- 🔗 プロフィールへ戻る -->
<div class="mt-10 text-center">
  <%= link_to "← プロフィールへ戻る", user_path(@user),
      class: "text-sm text-purple-600 hover:underline" %>
</div>

  </div>
</div>
